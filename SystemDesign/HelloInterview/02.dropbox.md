## Drop Box
<br/>

### 요구사항
<br/>

|   구분   |                                          내용                                           |
|:------:|:-------------------------------------------------------------------------------------:|
|  핵심기능  |                 - 파일 업로드, 다운로드(어느기기 에서나)<br/> - 동기화<br/> - 사용자간 파일공유                  |
| 비기능 요구 | - 고가용성(가용성 > 일관성)<br/> - 대용량 파일 업로드<br/>- 파일 손실시 복구<br/>- 업로드, 다운로드, 동기화시 low latency |
|  선택기능   |                   - 사용자당 저장한도<br/> - 파일 버전 관리<br/> - 파일에 대한 바이러스 검사                   |

### 주요 엔티티
<hr/>

* File: 실제 파일 데이터(바이너리)
* FileMetadata: 파일명, 크기, MIME 타입, 업로더, 상태 등 메타정보 
* User: 사용자 정보

### 구조
<hr/>

|   시스템   |                         역활                         |
|:-------:|:--------------------------------------------------:|
|  클라이언트  |    웹, 데스크톱, 모바일 앱. 파일 변경 감지, 업로드/다운로드, 동기화 처리      |
|  LB & API Gateway  |             부하 분산, 요청 라우팅, SSL, 요청 검증              |
|  파일 서비스 | 파일 메타데이터 DB 관리, Presigned URL 요청(Blob Storage와 연동) |
|  파일 메타데이터 DB  |   파일명, 크기, 업로더, 공유 목록 등 메타데이터 저장. 권한 및 동기화 상태 관리   |
| Blob Storage(S3 등) |                    실제 파일 콘텐츠 저장                    |
| CDN|                 파일 캐싱, 빠른 다운로드 지원                  |

### 요구사항 충족
<hr/>

* 모든 장치에서 파일업로드
  * Blob Storage(S3 등)에 파일 업로드. 서버 부하 분산 및 업로드 속도 향상
* 사용자는 모든 장치에서 파일을 다운로드 가능
  * 서버에서 Presigned URL 생성하여 클라이언트에 전달
  * 메타데이터 DB에 파일 상태(업로드 중/완료) 기록, 중단 시 재개 가능
* 사용자는 다른 사용자와 파일을 공유
  *  메타데이터 DB에 공유 사용자 목록(sharelist) 저장
* 사용자는 여러 기기에서 파일을 자동으로 동기화 가능
  * 로컬 변경 감지
    *  OS 파일 이벤트(FileSystemWatcher, FSEvents 등)로 파일 변경 감지
  * 원격 변경 감지
    * 폴링: 주기적으로 서버에 변경 여부 확인(단순, 실시간성 부족)
    * WebSocket/SSE: 서버가 변경 시 클라이언트에 실시간 알림(실시간 동기화)
    * 충돌 처리: 마지막 변경 우선(Last Write Wins) 정책 적용
    * Pub/Sub 시스템: 파일 변경 시 구독 클라이언트에 실시간 알림
* 대용량 파일(최대 50GB 등)을 지원
  * 파일 청킹(Chunking): 파일을 5~10MB 단위로 분할, 각 청크별로 업로드/다운로드
  * 메타데이터 DB에 청크별 상태 저장, 중단 시 완료된 청크는 재업로드하지 않음
* 업로드, 다운로드, 동기화를 빠르게 지원
  * CDN 활용: 파일 캐싱으로 사용자와 가까운 위치에서 빠른 다운로드 제공
* 파일 보안
  * 전송 중: 모든 통신 암호화
  * 저장 중: Blob Storage에서 파일 암호화(AES-256 등)