## 분산시스템 이론과 구조
<hr/>

### CAP(브루어의 정리)
<hr/>

* 일관성, 가용성, 파티션 허용성 간 상충관계를 설명
* 일반적인 상황에서 파티션허용성(분할내성)은 포기할수 없으므로 CP, AP 중 하나를 선택해야함

#### 파티션 허용성(P)

* 시스템의 노드 간 통신 중단이 아무리 많아도 클러스터가 계속 작동해야 함

#### 일관성(C)

* 어떤 노드에 연결하든 모든 클라이언트가 동시에 동일한 데이터를 볼 수 있음

#### 가용성(A)

* 데이터를 요청하는 모든 클라이언트가 하나 이상의 노드가 다운된 경우에도 응답을 받는다는 것

### PACELC
<hr/>

* CAP 의 연장성
* P: 파티션 허용성
* A: 가용성
* C: 일관성
* E: else
  * 네트워크 파티션이 발생하지 않는 정상적 작동상태
  * L, C 둘증에 하나를 선택해야 한다
* L: 지연시간
* C: 일관성 수준

### 팩소스, 래프트
<hr/>

* 네트워크 분할이나 정상적으로 동작하지 않는상태에서 여러노드간 합의를 이끌어내는 알고리즘
* 합의란 서로다른 서버가 동일한 상태나 결정을 유지하도록 하는 과정

#### 팩소스

* 시스템 내 모든 노드가 동의해 시스템 일관성을 유지하고 서로다른 값을 업데이트함
* 여러 단계의 통신을 거쳐 각 노드가 하나의 값으로 일치할수 있도록 하여 안정적 운영
* 핵심 포인트
  * 제안자: 합의 프로세스를 시작하는 역활, 값을 제안받고 다른 노드에 전파
  * 수용자: 제안제에게 제안을 받고 제안이 수용되었는지 다른 노드에 알림
  * 학습자: 합의된 값을 최종적으로 받아서 후속작업을 수행
* 프로토콜 과정
  * 준비단계: 제안자는 고유 제안번호를 선택하여 많은 최대한 만든 수용자에게 준비 요청을 보내고 수용자는 제안받은 가장 높은 번호의 제안을 응답으로 반환
  * 수용단계: 제안자가 수용자에게 응답을 받으면 수용단계로 넘어감, 제안자는 자신의 제안 번호와 값을 담아 수용자에게 수용 요청을 보낸다
  * 합의점 도달: 여러 수용자가 제안을 수용하면 합의가 되어 해당 값이 선택됨, 이후 학습자에게 선택한 값 전달
* 고려 사항
  * 장애 허용성: 장애가 발생해도 원활하게 작동해야함
  * 확장성: 노드의 개수에 영향을 받음으로 고려 해야함
  * 복잡성: 팩소스 알고리즘은 복잡 하므로 모든 참여자가 프로토콜을 따를수 있게 해야함
* 최적화 기법
  * 멀티팩소스
    * 값 여러개에 대해 지속적 합의 할수 있음
    * 준비단계와 수용단계의 반복을 피할수 있다
  * 패스트 팩소스
    * 합의헤 필요한 메시지수를 줄인다
    * 제안자가 일반적인 준비단계를 건너뛰고 수용자에게 값 제안할수 있음
  * 심플 팩소스
    * 준비와수용을 하나의 라운드로 통합
* 사례
  * 분산 데이터베이스
  * 분산 파일 시스템
  * 상태기계복제

#### 래프트