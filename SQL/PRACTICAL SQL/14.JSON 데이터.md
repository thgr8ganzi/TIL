
## JSON

* JSON(JavaScript Object Notation)은 자바스크립트 객체 표기법으로, 데이터를 저장하거나 전송할 때 많이 사용하는 경량의 데이터 교환 형식이다.
* 텍스트 형식으로 플랫폼에 종속되지 않아 여러 컴퓨터에서 쉽게 공유 할수 있다.
* ANSISQL 표준은 2016년에 JSON 에 대한 구문 정의를 추가하며 JSON 개체를 만들고 액세스 하는 함수를 추가했다.
* PostgreSQL 은 여러 비 표준 연산자를 구현해 ANSI 표준에 대한 지원 일부를 추가했다

### JSON 구조 이해

* 키/값 쌍으로 이루어진 객체이다
* 순서가 지정된 값 모음인 배열
* 개체 내부에 키/값 쌍을 사용해 개별 데이터 항목을 저장하고 이름을 부여할수 있다.
* 개체 전체는 중괄호로 묶고 그 안에서 각 이름은 큰 따옴표로 묶은 키를 입력한 뒤에 콜론과 해당 값을 입력한다.
* 개체는 쉼표러 구분된 여러 키/값 쌍을 캡슐화 한다.
* 문자는 큰따옴표로 묶고 숫자, 불리언, null 은 따옴표로 묶지 않는다.
* 배열은 대괄호로 묶은 순서가 정해진 목록이고 쉼표로 구분한다.

### SQL 에서 JSON 사용 여부 결정하기

* NoSQL 이나 문서형 데이터 베이스를 사용하면 얻을수 있는 이점은 관계형 테이블 대신 JSON 또는 기타 텍스트 기반 데이터 형식으로 데이터를 저장한다.
* 문서 데이터베이스는 데이터 정의 측면에서 유연하다. 필요하면 바로 데이터 구조를 재정의 할수 있다.
* 또한 서버를 추가하여 확장할수 있기 때문에 대용량 애플리케이션에도 자주 사용된다.
* 문서 데이터베이스를 사용하면 SQL 이 가진 이점은 포기하게 된다.
* 제약사항을 추가해 데이터 무결성을 강화하거나 트랜잭션에 대한 지원을 받을수 없다.
* 하지만 SQL 에 JSON 지원이 도입되면 관계형 테이블 열에 JSON 데이터를 추가하며 두가지 장점을 모두 누릴수 있다.
* PostgreSQL 은 속도면에서 NoSQL 에 비해 성능이 우수하지만 저장되는 데이터의 종류와 양, 제공되는 애플리케이션의 용도도 고려해야 한다.
* SQL 에 JSON 을 활용하면 좋은 예
  * 사용자 또는 애플리케이션이 키/값 쌍을 임의로 생성하야 하는 경우
  * 관련 데이터를 별도의 테이블이 아닌 JSON dufdp wjwkdgksms ruddn
  * 시간 절약을 위해 다른 시스템에서 가져온 JSON 을 분석하는 경우
* SQL 에서 JSON 을 사용하는 것은 문제가 될수 있다.
* 일반 SQL 테이블에서 설정하기 쉬운 제약 조건이 JSON 데이터에서는 설정하기 어려울수 있따.
* JSON 구조를 정의하는 따옴표와 쉼표, 중괄호, 키 이름이 텍스트에서 반복되어 더 많은 용량을 차지한다.
* JSON 유연성 때문에 키가 예기치 않게 사라지거나 값의 데이터 타입이 변경되면 다른 언어와 상호작용 하는 코드에 문제가 발생할수 있다.

### JSON 및 JSONB 데이터 타입 사용

* JSON 은 텍스트로 저장하고 JSONB 는 바이너리 데이터로 저장한다.
* 바이너리는 비교적 최근 지원하게 된 타입이다.
* 많은 이용자들은 바이너리 구현을 선호하는데 텍스트 구현과 비교했을때 쿼리 속도가 더 빠르고 인덱싱 기능이 있기 때문이다.
* JSON
  * JSON 텍스트로 저장하고 공백을 유지하며 키 순서를 유지한다.
  * 단일 JSON 개체에 특정 키가 두번이상 포함된 경우 json 타입은 반복되는 각 키/값 쌍을 유지한다.
  * 마지막으로 데이터 베이스 함수가 json 에 저장된 텍스트를 처리할때마다 구조를 해석하기 위해 개체를 분석한다.
  * 이 경우 jsonb 보다 데이터베이스 읽기 속도가 느려진다.
  * 인덱싱을 지원하지 않는다.
  * json 타입은 애플리케이션에 중복 키가 있거나 키 순서를 유지해야 할때 유용하다
* JSONB
  * JSON 을 바이너리 형식으로 저장하고 데이터의 공백을 제거 하며 키 순서를 유지하지 않는다.
  * 단일 JSON 개체에 특정키가 두번이상 포함된 경우 jsonb 타입은 마지막 키/값 쌍만 보존한다.
  * 바이너리 형식은 테이블에 데이터를 쓰는데 약간의 오버헤드를 주기만 처리속도가 빠르다
  * 인덱싱 지원
* JSON, JSONB 모두 ANSI SQL 표준에 해당하지 않는다.
* PostgreSQL 은 JSONB 타입을 권장한다.

### JSON 데이터 가져오고 인덱싱

* 