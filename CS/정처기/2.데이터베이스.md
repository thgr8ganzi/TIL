## 데이터베이스 구축

### 데이터베이스 개념

* 데이터와 정보
  * 데이터 : 관찰이나 측정을 통해 수집한 사실이나 값
  * 정보 : 데이터를 처리하여 의시 결정에 유용하게 정리한 결과물
* 데이터 베이스
  * 특정 조직에 업무에 필요한 데이터들 집합
* 정의
  * 통합 데이터 : : 중복이 최소화된 데이터
  * 저장 데이터 : 컴퓨터가 접근할 수 있는 저장 매체에 저장된 데이터
  * 운영 데이터 : 조직의 업무를 수행하는데 있어서 존재 가치가 있는 데이터
  * 공용 데이터 : 여러 응용 시스템들이 공동으로 소유하고 유지하는 데이터
* 특징
  * 실시간 접근성
  * 계속적인 변화
  * 동시 공유
  * 내용에 의한 참조
  * 데이터의 독립성
* 생명주기
  * 분석 - 설계 - 구현 - 운영 - 감시 및 개선
* 데이터 언어
  * DDL(Data Definition Language) : 데이터 정의 언어
  * DML(Data Manipulation Language) : 데이터 조작 언어
  * DCL(Data Control Language) : 데이터 제어 언어
* 스키마
  * 정의
    * 데이터베이스의 구조, 제약 조건, 속성, 개체, 관계를 포함한 전반적인 명세
  * 3계층 스키마
    * 외부 스키마
      * 사용자나 응용 프로그램의 관점에서 데이터 베이스의 논리적 구조정의
      * 서브 스키마라고 불리며 하나의 데이터베이스에 여러개의 외부스키마가 존재
      * 여러 응용 프로그램이나 사용자가 하나의 외부 스키마를 공유할수 있다
    * 개념 스키마
      * 데이터베이스의 전체적인 논리적 구조를 나타내며 전체 조직의 데이터 요구사항을 종합적으로 반영
      * 하나의 개념 스키마만 존재
      * 스키마는 주로 개념 스키마
      * 데이터 접근 권한, 보안 정책, 무결성 규칙등의 명세 포함
    * 내부 스키마
      * 물리적 저장장치 관점에서 데이터 베이스의 구조 정의
      * 실제로 데이터가 어떻게 저장 장치에 배열되고 저장되는지, 레코드의 물리적 구조, 표현 방식, 순서등을 명세
    * 데이터 독립성
      * 논리적 독립성
        * 응용 프로그램에 영향을 주지 않고 데이터 베이스 논리적 구조를 변경할수 있는 능력
        * 개념 스키마가 변경되어도 외부 스키마에는 영향을 미치지 않도록 지원
      * 물리적 독립성
        * 응용 프로그램이나 데이터 베이스의 논리적 구조의 영향을 미치지 않고 데이터의 물리적 구조를 변경할수 있는 능력
        * 내부 스키마가 변경되어도 외부/개념 스키마가 영향을 받지 않도록 지원

### 데이터베이스 관리 시스템





-----------------------------------------------

## 데이터 모델링

### 데이터 모델

* 개념
  * 현실 세계의 복잡한 데이터 구조를 단순화
* 종류
  * 계층형 모델
  * 네트워크 형 모델
  * 관계형 모델
  * 객체지향 형 모델
* 구분
  * 개념적
  * 논리적
  * 물리적
* 구조
  * 개체 : 저장할만한 가치가 있는 현실 세계의 대상체
  * 개체타입 : 개체를 구성하는 속성들의 집합
  * 개체 인스턴스 : 구체적인 개체
  * 개체 세트 : 개체 인스턴스들의 집합
  * 속성 : 개체의 고유한 특성
  * 관계 : 개체와 개체간의 연관성
  * 구조 : 데이터 구조및 개체관 관계
  * 연산 : 데이터 처리 방법
  * 제약 조건
  * 데이터의 논리적 제약 조건

### 개체 관계 모델(Entity Relationship Model)

* 개념
  * 데이터 베이스의 요구사항을 그래픽적으로 표현
  * 피터첸에 의해 제안
  * 산출물 : ERD(Entity Relationship Diagram)
* 개체
  * 현실 세계의 독립적이고 구별 가능한 대상
  * ERD 에서는 사각형
* 속성
  * 애틀리뷰트
  * 개체나 관계의 공유한 특성을 나타내는 정보의 단위
  * DRD 에서는 원으로 표현 키는 밑줄 다중값은 구대의 원 유도 속성은 원을 점선
  * 속성 유형
    * 단일값 속성 : 하나의 값만 속성
    * 다중값 속성 : 여러값을 갖는 속성
    * 단순 속성 : 더이상 분해할수 없는 속성
    * 복합 속성 : 분해 가능한 속성
    * 유도 속성 : 다른 속성에서 유도되는 속성
    * 널 속성 : 값이 아직 결정되지 않거나 존재하지 않는 속성
    * 키 속성 : 개체를 구별하기 위한 속성
* 관계
  * 두 개체간 의미있는 연결
  * ERD 에서는 마름모
  * 대응 종류
    * 1 : 1
    * 1 : N
    * M : N

### 데이터모델 품질 기준

* 정확성
* 완전성
* 준거성
* 최신성
* 일관성
* 활용성

-----------------------------------------------

## 논리 데이터베이스 설계

### 논리적 모델링

* 개념
  * 개념적 설계 단계에서 도출된 개체, 속성, 관계를 구족적으로 표현
  * 정규화
  * 특정 DBMS에 종속적이지 않은 데이터 모델링
* 종류
  * 관계형
  * 계층형
  * 네트워크
  * 객체지향

### 정규화

* 개념
  * RDB 의 설계에서 데이터 중복을 최소화 하기 위한 과정
  * 중복 데이터를 허용하지 않아 무결성 유지와 저장 용령 절감
* 목적
  * 데이터 중복 최소화
  * 정보의 무손실
* 장점
  * 중복 데이터 최소화
  * 저장 공간 효율적 활용
  * 이상 현상 제거
* 단점
  * 처리 복잡성 증가
  * 실행 속도 저하
  * 참조 무결성 유지에 추가 노력 필요
* 이상현상
  * 데이터 중복으로 인해 릴레이션 조작시 발생하는 예기치 않은 문제점
* 종류
  * 삽입 이상 : 데이터를 삽일할때 불필요한 데이터가 함께 삽입된느 현상
  * 삭제 이상 : 튜플을 삭제할때 연쇄 삭제 현상으로 인해 정보 손실
  * 갱신 이상 : 튜플의 속성값을 갱신 할때 일부 튜플의 정보만 갱신되어 정보에 모순이 생기는 현상
* 함수적 종속
  * 어떤 릴레이션 R의 X와 Y를 각각 속성의 부분 집합이라고 가정했을때
  * X의 값을 알면 Y의 값을 바로 식별할수있고 X의 값에 Y 값이 달라질때 Y는 X에 함수적 종속
  * x -> y
  * 완전 함수적 종속 : 종속자가 기본키에만 종속되며, 기본키가 여러 속성으로 구성되어 있을때 기본키를 구성하는 모든 속성이 포함된 기본키의 부분 집합에 종속된 경우
  * 부분 함수적 종속 : 기본키가 여러 속성으로 구성되어 있을때 기본키를 구성하는 속성중 일부만 종속되는 경우
  * 이행적 함수 종속 : X -> Y, Y -> Z 일때 X -> Z 가 성립되는 경우
  * 정규화 과정 : 비정규 릴레이션 -> 1NF -> 2NF -> 3NF -> BCNF -> 4NF -> 5NF
* 정규화 과정
  * 1NF : 릴레이션의 모든 속성이 원자값을 갖도록 분해
  * 2NF : 1NF 이면서 기본키가 아닌 속성이 기본키에 완전 함수적 종속
  * 3NF : 2NF 이면서 기본키가 아닌 속성이 기본키에 이행적 함수적 종속이 아닌 경우
  * BCNF : 3NF 이면서 모든 결정자중 후보키가 아닌것들 제거
  * 4NF : 다치 종속을 제거
  * 5NF : 조인 종속을 제거

-----------------------------------------------

## 물리 데이터베이스 설계

### 물리 데이터 베이스 설계

* 과정
  * 사용자 DBMS 결정
  * 데이터 타입 결정
  * 역정규화
* 특징
  * 논리적 설계를 물리적인 데이터 모델로 매핑
* 고려사항
  * 무결성
  * 일관성
  * 회복성
  * 보안
  * 효율성
  * 확장성
* 논리-물리 데이터 모델 변환
  * Entitiy 를 table 로 변환
  * 속성을 컬럼으로 변환

### 반정규화

* 개념
  * 데이터 베이스 설계에서 정규화를 거친후 성능향상이나 개발 및 운영의 편의성을 위해 의도적으로 중복을 허용하거나 데이터를 재구성 하는 기법
* 고려사항
  * 데이터 중복으로 인해 데이터 무결성이 손상될 위험이 있다
  * 읽기 작업은 빨라지지만 삽입, 삭제, 수정은 느려질수 있다.
* 적용순서
  * 반정규화 대상 조사
  * 다른 방법 유도
  * 반정규화 수행
* 유형
  * 테이블 분할
    * 수평 분할
    * 수직 분할
  * 테이블 중복
    * 통계 테이블 추가
    * 진행 테이블 추가
  * 컬럼기반 분할
    * 조회 빈도 기반
    * 크기 기반 분할
  * 컬럼 중복
    * 중복 컬럼 추가
    * 파생 컬럼 추가

### 테이블 저장 사이징

* 분석
  * 정확한 데이터 용량을 산정하여 디스크 사용의 효율을 높임
* 테이블 사이징
  * 초기 크기 계산
  * 확장 크기 계산
  * 테이블 용량 계싼
  * 이ㄴ덱스 용량 계산

### 데이터 베이스 이중화

* 이중화 구성
  * 장애에 대비하여 동일한 데이터 베이스를 중복하여 관리하는 방식
  * 고가용성을 위한 정보 시스템의 지속적인 정상 운영을 목표로 함
* 목적
  * 장애나 재해 발생시 빠른 서비스 재개
* 분류
  * Eager : 트랜잭션 발생시 즉시 모든 이중화 서버에 반영
  * Lazy : 트랜잭션 완료후 변경 사항을 트랜잭션 형태로 각 노드에 전달
* 종류
  * Active - Active : 모든 다중화된 장비가 활성화
  * Active - Standby : 하나의 장비만 활성화

### 데이터베이스 백업

* 개념
  * 중단 사태에 대비하여 데이터를 주기적으로 복사하여 보관
* 백업 방식
  * 전체 백업 : 저장된 폴더의 모든 데이터 백업
  * 증분 백업 : 최근 전체 백업 이후 변경/추가된 데이터만 백업
  * 차등 백업 : 최근 전체 백업 이후 모든 변경/추가된 데이터를 백업
  * 실시간 백업 : 데이터 변경시 즉시 백업
  * 트랜잭션 로그 백업 : 실행된 SQL 문을 기록한 로그, REDO 및 UNDO 작업을 통해 데이터 베이스 복원
  * 합성 백업 : 기존의 전체 백업과 여러개의 증분 백업으로 전체 백업 만듬
* 복구 시간 목표/복구 시점 목표
  * 복국 시간 목표(RTO)
    * 서비스가 중단된후 서비스를 다시 복원할때 까지 허용되는 최대 시간
  * 복구 시점 목표(RPO)
    * 마지막 백업 이후 허용되는 최대 데이터 손실 시간

### 암호화

* 개념
  * 데이터베이스 내뇽을 암호화 하는 과정
* 필요성
  * 데이터 가치 증가
* 암호화 방식
  * API 방식 : 애플리케이션에서 데이터의 암/복호화 수행
  * Plug-in 방식 : DB 서버에 제품 설치후 암/복호화 수행
  * TDE(Transparent Data Encryption) : DBMS 에서 제공하는 암/복호화 기능을 활용
  * 파일 암호화
  * 하드웨어 방식
* 국가정보원 권고사항
  * 안전한 알고리즘
  * 암호 키 관리
  * 데이터 암/복호화
  * 접근 통제
  * 암호 통신
  * 식별 및 인증
  * 보안 감사
  * 보안 관리

-----------------------------------------------

## 데이터베이스 물리 속성 설계

### 파티셔닝

* 파티셔닝
  * 데이터베이스의 특정 부분을 여러 섹션으로 분할
  * 대용량 데이터의 조회속도 향상 관리 용이성 성능 및 가용성 향상을 위해 사용
* 샤딩
  * 거대한 데이터 베이스나 시스템을 작은 조각으로 나누어 분산 저장 및 관리 기법
  * 데이터의 크기가 매우 클때 효과적
  * 샤드는 나눠진 데이터 블록의 구간을 의미
* 파티셔닝 장점
  * 데이터 가용성 향상
* 파티셔닝 단점
  * 테이블간 조인 비용증가
* 종류
  * 수평분할
    * 테이블의 행을 기준으로 분할
    * 스키마를 복제후 샤드키를 기준으로 데이터를 나눔
  * 수직분할
    * 테이블의 컬럼을 기준으로 분할
    * 자주 사용하는 컬럼을 분리
    * 하나의 테이블을 2개 이상으로 분할
* 분할기분
  * 범위 분할
    * 파티션 키의 연속된 범위로 정의
  * 목록 분할
    * 특정 파티션에 저장될 데이터에 대한 명시적 제어
  * 해시 분할
    * 파티션 키 값에 해시 함수를 적용하고 거기서 반환된 값으로 파티션 매핑
    * 병렬 처리시 성능 효과 극대화
  * 라운도 로빈 분할
    * 데이터를 균일하게 분배해서 저장
  * 합성 분할
    * 위기술들 복합적 사용

### 클러스터

* 개념
  * 자주 사용되는 테이블의 데이터를 디스크 상 동일한 위치에 저장하여 데이터 액세스 효율을 향상 시키는 물리적 저장방법
* 특징
  * 그룹화된 데이터는 같은 데이터 블록에 저장되어 디스크 I/O 횟수를 줄임
* 대상 테이블
  * 데이터 분포도가 넓은 테이블

### 인덱스

* 개념
  * 특정 데이터베이스 테이블 검색 속도 향상을 위한 저장 공간 활용 자료 구조
* 사용 이유
  * 대규모 테이블에서 빠른 데이터 추출
* 종류
  * 클러스 인덱스
    * 테이블당 1개면 허용 해당 컬럼을 기준으로 테이블이 물리적 정렬
    * 데이터는 기본적으로 오름 차순으로 정렬
  * 논 클러스터 인덱스
    * 테이블당 약 240개의 인덱스 생성 가능
    * 레코드의 원본은 정렬디지 않고 인덱스 페이지만 정렬
  * 밀집 인덱스
    * 데이터 레코드 각각ㅇ 대해 하나의 인덱스가 만들어짐
  * 희소 인덱스
    * 레코드 그룹 또는 데이터 블록에 대해 하나의 인덱스 만들어짐
* 인덱스 구조
  * 트리 기반 인덱스
  * 비트맵 인덱스
  * 함수 기반 인덱스
  * 비트맵 조인 인덱스
  * 도메인 인덱스
* 컬럼 선정
  * 분포도가 좋은 컬럼
  * 자주 조합되어 사용되는 경우
  * 가능한 수정이 빈번하지 않은 컬럼
  * 한 컬럼이 여러 인덱스 포함되지 않도록
  * 기본키 및 외부키가 되는 컬럼
* 고려사항
  * 새로 추가된 인덱스는 기존 엑세스 경로에 영향 미칠수 있다
  * 지나치게 많은 인덱스는 오버헤드 발생
  * 넓은 범위 인덱스로 처리시 많은 오버헤드 발생
  * 옵티마이저를 위한 통계데이터 주기적 갱신

### 뷰

* 개념
  * 기본 테이블에서 유도된 이름이 있는 가상테이블
  * 실제 데이터를 저장하지 않고 논리적으로만 존재
  * 사용자는 실제 테이블과 같이 뷰를 조작 가능
* 특징
  * 기본 테이블 유도로 기본 테이블과 유사항 형태와 조작을 갖는다
  * 물리적 구현이 없는 가상 테이블
  * 기본테이블/ 뷰 삭제시 관련 뷰도 자동 삭제
* 장점
  * 논리적 데이터 독립성
  * 자동 보안
* 단점
  * 독립적 인덱스 부재
  * 뷰 조작에 제약(삽입, 삭제, 갱신)

### 시스템 카탈로그

* 개념
  * 데이터 베이스의 모든 데이터 개체들에 대한 정보를 저장한 시스템 테이블, 데이터 사전 이라고 한다
  * DDL의 결과로 생성되는 데이터 베이스 구조와 관련 통계 정보 저장
  * 메타 데이터
* 내용
  * 릴레이션
  * 인덱스
  * 뷰
  * 통계
  * 사용자
* 특징
  * 시스템 카탈로그 자체도 시스템 테이블로 구성
  * 사용자는 SQL 을 사용하여 내용 조회
  * DBMS 에 의해 생성
  * 사용자는 시스템 카탈로그 직접 갱신 X

-----------------------------------------------

## 관계 데이터베이스 모델

### 관계 데이터 모델

* 개념
  * 데이터의 논리적 구조를 테이블 형태로 표현
  * 각테이블은 튜플과 속성 으로 구성
* 구조
  * 속성
    * 릴레이션의 열을 속성
    * 개체의 특성 기술
    * 속성의 개수는 릴레이션의 차수
  * 튜플
    * 행을 튜플이라고 하며 속성들의 모임
    * 튜플의 수는 릴레이션의 카디널리티
  * 도메인
    * 속성이 가질수 있는 값의 범위
    * 도메인을 정의하면 무결성을 유지할수 있다
  * 차수
    * 릴레이션의 속성의 총개수
  * 카디널리티
    * 릴레이션에서 튜플의 총개수
* 릴레이션
  * 데이터들을 2차원 테이블의 구조로 저장
  * 구성
    * 릴레이션 스키마
    * 릴레이션 인스턴스
  * 특징
    * 튜플의 유일성
    * 튜플의 무순서성
    * 속성의 무순서성
    * 속성의 원자성
    * 동적 변화성

### 관계 데이터 언어(관계대수, 관계 해석)

* 관계 대수 개념
  * 관계 대수는 원하는 데이터를 찾기 위한 절차적 언어
  * 데이터를 어떻게 찾아야 하는지 처리 과정을 명시
* 순수 관계 연산자
  * SELECT
    * 주어진 조건을 만족하는 튜플
    * 시그마
  * PROJECT
    * 속성 리스트에 주어진 속성값만 추출
    * 파이
  * JOIN
    * 두 릴레이션에서 연관된 튜플을 결함
    * 보타이
  * DIVISION
    * 릴레이션 S 의 모든 튜플과 관련이 있는 릴레이션 R의 튜플들을 반환
    * 나누기
* 일반 집합 연산자
  * 합집합
    * 두 릴레이션의 튜플 합집합을 구하며 중복 튜플 제거
    * U
  * 교집합
    * 두 릴레이션의 공통 튜플을 구함
    * n
  * 차집합
    * 두 릴레이션의 차집합을 구함
    * -
  * 교차곱
    * 두 릴레이션의 모든 튜플의 조합을 구함
    * X
* 관계 해석
  * 관계 데이터 모델의 제안자인 코드가 수합의 술어 해석에 기반을 두고 관계 데이터베이스를 위해 제안
  * 계산 수식을 사용하여 원하는정보 정의
  * 원하는 정보가 무엇이라는것만 정의한는 비 절차적 특성

-----------------------------------------------

## 키와 무결성 제약 조건

### 속성

* 개념
  * 릴레이션에서 정보의 최소 단위로 각열을 통해 데이터의 상태나 특성 나타냄
  * 컬럼을 속성이라고 한다.
* 특징
  * 업무프로세스에 필요한 정보로 구성
  * 하나의 속성에는 하나의 값만
  * 여러값이 필요한 경우 테이블로 분리
* 분류
  * 기본속성 : 업무로 부터 추출한 모든 속성
  * 설계속성 : 코드성 데이터, 릴레이션 식별용 일련번호
  * 파생 속성 : 다른 속성에 영향을 받아 발생하는 속성
* 세부 의미에 따른 분류
  * 단순속성
  * 복합속성
* 구성 방식에 따른 분류
  * PK
    * 릴레이션에서 튜플을 유일하게 구분할수 있는 속성
  * FK
    * 다른 릴레이션과의 관계에서 참조하고 있는 속성
  * 일반속성
    * 릴레이션에 포함된 속성중 PK 와 FK 가 아닌 속성
* 도메인
  * 속성의 값 범위를 정의
  * 속성이 가질수 있는 가능한 모든값의 집합
* 부여원칙
  * 업무에서 사용하는 이름
  * 서술식 보다 간결한 이름
  * 약어 사용 자제

### 키

* 개념
  * 데이터 베이스에서 튜플을 식별하고 구별하는데 사용되는 컬럼
* 종류
  * 기본키
  * 대체키
  * 슈퍼키(최소성)
  * 후보키(유일성)